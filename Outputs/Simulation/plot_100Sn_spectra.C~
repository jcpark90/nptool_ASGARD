void plot_100Sn_spectra(){
  gStyle->SetOptStat(0);
  TLatex* latex = new TLatex();
  TFile* f = new TFile("outputs_100Sn.root");
  TFile* fd = new TFile("outputs_100Sn_doubleTau.root");
  TLine* line  = new TLine();
  TCanvas* cc = new TCanvas("cc", "cc", 1400, 600);
  cc->Divide(2,1);
  cc->cd(1);
  TH1D* he_idaten = (TH1D*)f->Get("he_idaten");
  TH1D* he_hpge = (TH1D*)f->Get("he_hpge");
  he_idaten->SetLineColor(1);
  he_idaten->GetXaxis()->SetTitle("Energy (keV)");
  he_idaten->GetYaxis()->SetTitle("Counts / 2 keV");
  he_idaten->GetXaxis()->SetRangeUser(0, 480);
  he_hpge->SetLineColor(2);
  he_idaten->Draw("hist");
  he_hpge->Rebin(2);
  he_hpge->Draw("Same");
  TLegend* legend = new TLegend(0.7, .7, 0.9, 0.9);
  legend->AddEntry(he_idaten, "IDATEN", "l");
  legend->AddEntry(he_hpge, "HPGe", "l");
  legend->Draw();

  latex->DrawLatex(250, 40, "^{100}Sn #rightarrow ^{100}In");
  
  cc->cd(2);
  TH1D* ht_idaten_plastic_141 = (TH1D*)f->Get("ht_idaten_plastic_141");
  ht_idaten_plastic_141->SetLineColor(1);
  ht_idaten_plastic_141->Sumw2();
  ht_idaten_plastic_141->Rebin(2);
  ht_idaten_plastic_141->Draw("hist");
  ht_idaten_plastic_141->GetXaxis()->SetTitle("T_{IDATEN} - T_{plastic} (ns)");
  ht_idaten_plastic_141->GetYaxis()->SetTitle("Counts / 0.1 ns");
  ht_idaten_plastic_141->GetXaxis()->SetRangeUser(-1.5, 1.5);
  ht_idaten_plastic_141->GetYaxis()->SetRangeUser(0, 50);
  
  TF1* f141 = new TF1("f141", "gaus", -1.5, 1.5);
  f141->SetLineColor(1);
  ht_idaten_plastic_141->Fit(f141, "REN0");
  f141->Draw("same");
  TH1D* ht_idaten_plastic_95 = (TH1D*)f->Get("ht_idaten_plastic_95");
  ht_idaten_plastic_95->SetLineColor(2);
  ht_idaten_plastic_95->Sumw2();
  ht_idaten_plastic_95->Rebin(2);
  ht_idaten_plastic_95->Draw("same hist");
  TF1* f95 = new TF1("f95", "gaus", -1.5, 1.5);
  f95->SetLineColor(2);
  ht_idaten_plastic_95->Fit(f95, "REN0");
  f95->Draw("same");
  TH1D* ht_idaten_plastic_40 = (TH1D*)f->Get("ht_idaten_plastic_40");
  ht_idaten_plastic_40->SetLineColor(4);
  ht_idaten_plastic_40->Sumw2();
  ht_idaten_plastic_40->Rebin(2);
  ht_idaten_plastic_40->Draw("same hist");
  TF1* f40 = new TF1("f40", "gaus", -1.5, 1.5);
  f40->SetLineColor(4);
  ht_idaten_plastic_40->Fit(f40, "REN0");
  f40->Draw("same");

  TH1D* ht_idaten_plastic_d_141 = (TH1D*)fd->Get("ht_idaten_plastic_141");
  ht_idaten_plastic_d_141->SetLineColor(1);
  ht_idaten_plastic_d_141->Sumw2();
  ht_idaten_plastic_d_141->Rebin(2);
  ht_idaten_plastic_d_141->SetLineStyle(2);
  ht_idaten_plastic_d_141->Draw("hist same");
  ht_idaten_plastic_d_141->GetXaxis()->SetTitle("T_{IDATEN} - T_{plastic_d} (ns)");
  ht_idaten_plastic_d_141->GetYaxis()->SetTitle("Counts / 0.1 ns");
  
  TF1* fd141 = new TF1("f141", "gaus", -1.5, 1.5);
  fd141->SetLineColor(1);
  ht_idaten_plastic_d_141->Fit(fd141, "REN0");
  fd141->Draw("same");
  fd141->SetLineStyle(2);
  TH1D* ht_idaten_plastic_d_95 = (TH1D*)fd->Get("ht_idaten_plastic_95");
  ht_idaten_plastic_d_95->SetLineColor(2);
  ht_idaten_plastic_d_95->Sumw2();
  ht_idaten_plastic_d_95->Rebin(2);
  ht_idaten_plastic_d_95->SetLineStyle(2);
  ht_idaten_plastic_d_95->Draw("same hist");
  TF1* fd95 = new TF1("f95", "gaus", -1.5, 1.5);
  fd95->SetLineColor(2);
  fd95->SetLineStyle(2);
  ht_idaten_plastic_d_95->Fit(fd95, "REN0");
  fd95->Draw("same");
  TH1D* ht_idaten_plastic_d_40 = (TH1D*)fd->Get("ht_idaten_plastic_40");
  ht_idaten_plastic_d_40->SetLineColor(4);
  ht_idaten_plastic_d_40->Sumw2();
  ht_idaten_plastic_d_40->Rebin(2);
  ht_idaten_plastic_d_40->SetLineStyle(2);
  ht_idaten_plastic_d_40->Draw("same hist");
  TF1* fd40 = new TF1("f40", "gaus", -1.5, 1.5);
  fd40->SetLineColor(4);
  fd40->SetLineStyle(2);
  ht_idaten_plastic_d_40->Fit(fd40, "REN0");
  fd40->Draw("same");

  TLegend* legendt = new TLegend(0.7, .7, 0.9, 0.9);
  legendt->AddEntry(ht_idaten_plastic_141, "141-keV", "l");
  legendt->AddEntry(ht_idaten_plastic_95, "95-keV", "l");
  legendt->AddEntry(ht_idaten_plastic_40, "40-keV", "l");
  legendt->Draw();
  line->DrawLine(0, 0, 0, 50);
  cc->SaveAs("100Sn_decay_spectra_doubleTau.png");
}
